<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="generation">

	<!-- 방생성 -->
    <insert id="insertStep1" parameterType="com.javaex.vo.ChallengeVo" useGeneratedKeys="true" keyProperty="roomNum">
    	<![CDATA[
    		INSERT INTO `roomInfo` (roomTypeNum, roomMaker)
        	VALUES (#{roomTypeNum}, #{userNum})
    	]]>
    </insert>
    
    <!-- 카테고리 등록 -->
    <update id="updateStep2" parameterType="com.javaex.vo.ChallengeVo">
    	<![CDATA[
    		UPDATE roomInfo
			SET categoryNum = #{categoryNum},
			    roomKeyword = #{roomKeyword}
			WHERE roomNum = #{roomNum}
			AND roomMaker = #{userNum}
    	]]>
    </update>
    
    <!-- 이미지, 타이틀, 설명 등록 -->
    <update id="updateStep3" parameterType="com.javaex.vo.ChallengeVo">
    	<![CDATA[
    		UPDATE roomInfo
			SET roomTitle = #{roomTitle},
			    roomDescription = #{roomInfo},
			    roomThumbNail = #{roomThumbNail}
			WHERE roomNum = #{roomNum}
			AND roomMaker = #{userNum}
    	]]>
    </update>
    
     <!-- 방 상세설정 업데이트 -->
    <update id="updateStep4" parameterType="com.javaex.vo.ChallengeVo">
    	<![CDATA[
    		UPDATE roomInfo
			SET roomMaxNum = #{roomMaxNum},
			    roomMinNum = #{roomMinNum},
			    roomEnterPoint = #{roomPoint},
			    roomEnterRate = #{roomRate},
			    regionNum = #{regionNum}
			WHERE roomNum = #{roomNum}
			AND roomMaker = #{userNum}
    	]]>
    </update>
    
     <!-- 방 시작날짜+기간 업데이트 -->
    <update id="updateStep5" parameterType="com.javaex.vo.ChallengeVo">
    	<![CDATA[
    		UPDATE roomInfo
			SET roomStartDate = #{roomStartDate},
			    periodNum = #{periodType}
			WHERE roomNum = #{roomNum}
			AND roomMaker = #{userNum}
    	]]>
    </update>
    
    <!-- 방 평가방법 업데이트 -->
    <update id="updateEvaluationType" parameterType="com.javaex.vo.ChallengeVo">
    	<![CDATA[
    		UPDATE roomInfo
			SET evaluationType = #{evaluationType}
			WHERE roomNum = #{roomNum}
			AND roomMaker = #{userNum}
    	]]>
    </update>
    
    <!-- 방넘버 요일정보 인서트하기 -->
    <insert id="insertRoomDay" parameterType="com.javaex.vo.ChallengeVo" useGeneratedKeys="true" keyProperty="roomNum">
    	<![CDATA[
    		INSERT INTO `roomDay` (dateNum, roomNum)
        	VALUES (#{roomDayNum}, #{roomNum})
    	]]>
    </insert>
    
    <!-- 방에 모든 요일넘버 가져오기 -->
    <select id="">
    	<![CDATA[ 
    		select rd.dateNum AS roomDayNum
			from roomInfo r
			join roomDay rd on rd.roomNum =  r.roomNum
			where r.roomNum = #{roomNum}
    	]]>
    </select>
    
    
    
</mapper>
